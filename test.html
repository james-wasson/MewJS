<html>

<head>
    <script src="./dist/bundle.js"></script>
    <script>
        var childComp = new MewJS.Component({
            parent: {
                props: { 
                    'prop2Child': 'prop2-rename',
                    'p-sub-bottom': 'p-sub-bottom'
                },
                emit: ['event1']
            },
            self: {
                props: {
                    'prop2': {
                        value: 2,
                        type: 'number',
                    }
                },
                template: `<p m-on="{ click: function() { this.$emit.event1('uno', 'dos'); } }">c1</p>`,
                watchers: {
                    'prop2Child': function(newVal, oldVal) {
                        this.$emit.event1('uno', 'dos');
                    }
                }
            }
        });

        var rootComp = new MewJS.Component({
            parent: {
            },
            self: {
                props: {
                    'prop2': {
                        value: 2,
                        type: 'number',
                    },
                    'prop1': {
                        value: true,
                        type: 'boolean',
                    },
                    prop3: {
                        value: "black",
                        type: "string"
                    },
                    prop4: {
                        value: function() {
                            return 'black';
                        }
                    },
                    prop5: {
                        value: function(e) { console.log('event called: ', e); }
                    }
                },
                template: `
                    <div  m-bind:style="{ 'color': prop4() }"
                        m-show="true"
                        m-if="prop1"
                        m-on="{ 'click': prop5 }">
                        asd
                        <div m-comp="'component1'"></div>
                    </div>`,
                watchers: {
                    'prop2': function(newVal, oldVal) {
                        console.log("root", oldVal, newVal);
                    }
                }
            },
            children: {
                props: {
                    'm-sub-top': {
                        value: 2,
                        type: 'number'
                    }
                },
                components: {
                    'component1': [...Array(5).keys()].map(p => {
                        return { 
                            definition: childComp,
                            props: {
                                'p-sub-bottom': {
                                    value: 4,
                                    type: 'number'
                                },
                                'prop2-rename': 'prop2'
                            },
                            listeners: {
                                'event1': function() {
                                    console.log(arguments);
                                }
                            }
                        }
                    })
                }
            }
        });

        document.addEventListener("DOMContentLoaded", function(event) { 
            MewJS.MountComponent('#mountPoint', rootComp);
        });    
    </script>
</head>
<body>
    <div id="mountPoint"></div>
</body>
</html>
